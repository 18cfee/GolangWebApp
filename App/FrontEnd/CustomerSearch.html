<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="stylesheets/style.css"> 
    <title>The Cabin Form</title>
    </head>
    <div id="customer-search">
            <header> 
                    <div>Riverside Cabins Form</div>                
            </header>
            <form>
                <label for="fName">Search:</label>
                <input type="text" name="fName" placeholder="Id..." v-model="idFilter" v-on:input="refresh">
                <li v-for="customer in customers">
                    {{customer}}
                    <button v-on:click="formSelect(customer.Id)"> select cust</button>
                </li>
                <button v-on:click="createUser">Create New User</button>
            </form>
            <a href="index.html">HomePage</a>
            <a href="BasicCustomerInfo.html">BasicCustomerInfo</a>
            <a href="FormSelection.html">FormSelection</a>
            <a href="FormV1.html">FormV1</a>
        </div>
</html>

<script src="https://npmcdn.com/vue/dist/vue.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    new Vue({
        el: '#customer-search',
        data: {
            idFilter: 1,
            customers: "",
        },
        created: function() {
            this.refresh();
        },
        methods: {
            createUser: function() {
                axios.get('/getNewCustomer')
                .then(res => {
                    // may want to switch this to #'s since this is just info for front end
                    window.location.href = 'http://localhost:8081/BasicCustomerInfo.html?custId=' + res.data + '&formId=1';
                })
                .catch(error => {
                    alert(error);
                })
            },
            refresh: function() {
                if (this.idFilter >= 1) {
                    axios.get('/getCustomers?custId='+this.idFilter)
                    .then(res => {
                    this.customers = res.data
                    })
                }
            },
            formSelect: function(id) {
                window.location.href = 'http://localhost:8081/BasicCustomerInfo.html?custId=' + id;
            }
        }
    });
</script>